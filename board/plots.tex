\startGNUPLOTscript[bifurcation_xpp]
  set xlabel "$a_{15} = δₚ$ level";
  set ylabel "$A = $ T Cells ($\\times 10^3$)";
  set title "Bifurcation Diagram";
  set arrow from 0.5707,0.7 to 0.5707,0.3 as 12;
  set label "HB" at 0.5707,1 center;
  set arrow from 4.063,1.2 to 4.063,0.8 as 12;
  set label "HB" at 4.063,1.5 center;
  set key spacing 2;
  set xrange [0:30];
  set key inside right center;
  plot "mk_static.dat.1" using 1:($3==1?$2:1/0) title "Stable steady state" with lines ls 14,\
       "mk_static.dat.1" using 1:($3==1?1/0:$2) title "Unstable steady state" with lines ls 13,\
       "mk_static.dat.2" using 1:($3==3?$2:1/0) title "Stable periodic" with points ls 3,\
       "mk_static.dat.2" using 1:($3==3?1/0:$2) title "Unstable periodic" with points ls 43,\
       "mk_static.dat.3" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.3" using 1:($3==3?1/0:$2) notitle with points ls 43,\
       "mk_static.dat.4" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.4" using 1:($3==3?1/0:$2) notitle with points ls 43,\
       "mk_static.dat.5" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.5" using 1:($3==3?1/0:$2) notitle with points ls 43;
\stopGNUPLOTscript

\startGNUPLOTscript[bifurcation_xpp_simple]
  set xlabel "$a_{15} = \\delta_p = $\\chardef\\vulgarfractionmethod2\\vfrac1{beta~cell~level}";
  set ylabel "$A = $ T Cells ($\\times 10^3$)";
  set arrow from 0.5707,0.7 to 0.5707,0.3 as 12;
  set label "\\switchtobodyfont[18pt]HB" at 0.5707,1 center;
  set arrow from 4.063,1.2 to 4.063,0.8 as 12;
  set label "HB" at 4.063,1.5 center;
  set key spacing 2;
  set xrange [0:30];
  set key inside right center;
  plot "mk_static.dat.1" using 1:($3==1?$2:1/0) title "Stable steady state" with lines ls 14,\
       "mk_static.dat.1" using 1:($3==1?1/0:$2) title "Unstable steady state" with lines ls 13,\
       "mk_static.dat.2" using 1:($3==3?$2:1/0) title "Stable periodic" with points ls 3,\
       "mk_static.dat.2" using 1:($3==3?1/0:$2) title "Unstable periodic" with points ls 43,\
       "mk_static.dat.3" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.3" using 1:($3==3?1/0:$2) notitle with points ls 43,\
       "mk_static.dat.4" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.4" using 1:($3==3?1/0:$2) notitle with points ls 43,\
       "mk_static.dat.5" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.5" using 1:($3==3?1/0:$2) notitle with points ls 43;
\stopGNUPLOTscript

\startGNUPLOTscript[bifurcation_combined_0523]
  set xlabel "$a_{15} = δₚ$ level";
  set ylabel "$A = $ T Cells ($\\times 10^3$)";
  set xrange [0:3];
  set yrange [0:5];
  set title "Combined Diagram (0.5 to 2.3)";
  set arrow from 2.7,4.55 to 2.92,4.55 as 12;
  set arrow from 0.5707,1 to 0.5707,0.3 as 16;
  set label "HB" at 0.5707,1.3 center;
  plot "mk_static.dat.1" using 1:($3==1?$2:1/0) notitle with lines ls 14,\
       "mk_static.dat.1" using 1:($3==1?1/0:$2) notitle with lines ls 13,\
       "mk_static.dat.2" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.2" using 1:($3==3?1/0:$2) notitle with points ls 43,\
       "mk_static.dat.3" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.3" using 1:($3==3?1/0:$2) notitle with points ls 43,\
       "mk_static.dat.4" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.4" using 1:($3==3?1/0:$2) notitle with points ls 43,\
       "mk_static.dat.5" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.5" using 1:($3==3?1/0:$2) notitle with points ls 43,\
       "time_xpp_0523.dat" using 5:2 title "A (arrow indicates direction of time)" with lines ls 2;
\stopGNUPLOTscript

\startGNUPLOTscript[bifurcation_combined_12]
  set xlabel "$a_{15} = \\delta_p = $\\chardef\\vulgarfractionmethod2\\vfrac1{beta~cell~level}";
  set ylabel "$A = $ T Cells ($\\times 10^3$)";
  set xrange [0:3];
  set yrange [0:5];
  set title "Combined Diagram (0.1 to 2)";
  set arrow from 2.88,4.74 to 2.96,4.74 as 12;
  set arrow from 0.5707,1 to 0.5707,0.3 as 16;
  set label "HB" at 0.5707,1.3 center;
  plot "mk_static.dat.1" using 1:($3==1?$2:1/0) notitle with lines ls 14,\
       "mk_static.dat.1" using 1:($3==1?1/0:$2) notitle with lines ls 13,\
       "mk_static.dat.2" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.2" using 1:($3==3?1/0:$2) notitle with points ls 43,\
       "mk_static.dat.3" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.3" using 1:($3==3?1/0:$2) notitle with points ls 43,\
       "mk_static.dat.4" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.4" using 1:($3==3?1/0:$2) notitle with points ls 43,\
       "mk_static.dat.5" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.5" using 1:($3==3?1/0:$2) notitle with points ls 43,\
       "time_xpp_12.dat" using 5:2 title "\\switchtobodyfont[16pt] A (arrow indicates direction of time)" with lines ls 2;
\stopGNUPLOTscript

\startGNUPLOTscript[bifurcation_combined_21]
  set xlabel "$a_{15} = \\delta_p = $\\chardef\\vulgarfractionmethod2\\vfrac1{beta~cell~level}";
  set ylabel "$A = $ T Cells ($\\times 10^3$)";
  set xrange [0:3];
  set yrange [0:5];
  set title "Combined Diagram (2 to 0.1)";
  set arrow from 2.92,4.55 to 2.7,4.55 as 12;
  set arrow from 0.5707,1 to 0.5707,0.3 as 16;
  set label "HB" at 0.5707,1.3 center;
  plot "mk_static.dat.1" using 1:($3==1?$2:1/0) notitle with lines ls 14,\
       "mk_static.dat.1" using 1:($3==1?1/0:$2) notitle with lines ls 13,\
       "mk_static.dat.2" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.2" using 1:($3==3?1/0:$2) notitle with points ls 43,\
       "mk_static.dat.3" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.3" using 1:($3==3?1/0:$2) notitle with points ls 43,\
       "mk_static.dat.4" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.4" using 1:($3==3?1/0:$2) notitle with points ls 43,\
       "mk_static.dat.5" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.5" using 1:($3==3?1/0:$2) notitle with points ls 43,\
       "time_xpp_21.dat" using 5:2 title "\\switchtobodyfont[16pt] A (arrow indicates direction of time)" with lines ls 2;
\stopGNUPLOTscript

\startGNUPLOTscript[bifurcation_combined_12_long]
  set xlabel "$a_{15} = \\delta_p = $\\chardef\\vulgarfractionmethod2\\vfrac1{beta~cell~level}";
  set ylabel "$A = $ T Cells ($\\times 10^3$)";
  set xrange [0:3];
  set yrange [0:5];
  set title "Combined Diagram (0.1 to 2, 1000 days)";
  set arrow from 2.88,4.74 to 2.96,4.74 as 12;
  set arrow from 0.5707,1 to 0.5707,0.3 as 16;
  set label "HB" at 0.5707,1.3 center;
  plot "mk_static.dat.1" using 1:($3==1?$2:1/0) notitle with lines ls 14,\
       "mk_static.dat.1" using 1:($3==1?1/0:$2) notitle with lines ls 13,\
       "mk_static.dat.2" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.2" using 1:($3==3?1/0:$2) notitle with points ls 43,\
       "mk_static.dat.3" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.3" using 1:($3==3?1/0:$2) notitle with points ls 43,\
       "mk_static.dat.4" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.4" using 1:($3==3?1/0:$2) notitle with points ls 43,\
       "mk_static.dat.5" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.5" using 1:($3==3?1/0:$2) notitle with points ls 43,\
       "time_xpp_12_long.dat" using 5:2 title "\\switchtobodyfont[16pt] A (arrow indicates direction of time)" with lines ls 2;
\stopGNUPLOTscript

\startGNUPLOTscript[bifurcation_combined_h2]
  set xlabel "$a_{15} = δₚ$ level";
  set ylabel "$A = $ T Cells ($\\times 10^3$)";
  set xrange [0:18];
  set title "Demonstration of Ramping of Slowly Varying Parameter";
  set arrow from 17.45,3.65 to 16.1,3.65 as 12;
  set arrow from 0.5707,0.7 to 0.5707,0.3 as 12;
  set label "HB" at 0.5707,1 center;
  set arrow from 4.063,1 to 4.063,0.6 as 12;
  set label "HB" at 4.063,1.2 center;
  plot "mk_static.dat.1" using 1:($3==1?$2:1/0) notitle with lines ls 14,\
       "mk_static.dat.1" using 1:($3==1?1/0:$2) notitle with lines ls 13,\
       "mk_static.dat.2" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.2" using 1:($3==3?1/0:$2) notitle with points ls 43,\
       "mk_static.dat.3" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.3" using 1:($3==3?1/0:$2) notitle with points ls 43,\
       "mk_static.dat.4" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.4" using 1:($3==3?1/0:$2) notitle with points ls 43,\
       "mk_static.dat.5" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.5" using 1:($3==3?1/0:$2) notitle with points ls 43,\
       "time_xpp_h2.dat" using 5:2 title "A (arrow indicates direction of time)" with lines ls 2;
\stopGNUPLOTscript

\startGNUPLOTscript[bifurcation_combined_h2_forward]
  set xlabel "$a_{15} = δₚ$ level";
  set ylabel "$A = $ T Cells ($\\times 10^3$)";
  set xrange [0:18];
  set title "Demonstration of Ramping of Slowly Varying Parameter (Forward Direction)";
  set arrow from 16.1,3.65 to 17.45,3.65 as 12;
  set arrow from 0.5707,0.7 to 0.5707,0.3 as 12;
  set label "HB" at 0.5707,1 center;
  set arrow from 4.063,1 to 4.063,0.6 as 12;
  set label "HB" at 4.063,1.2 center;
  plot "mk_static.dat.1" using 1:($3==1?$2:1/0) notitle with lines ls 14,\
       "mk_static.dat.1" using 1:($3==1?1/0:$2) notitle with lines ls 13,\
       "mk_static.dat.2" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.2" using 1:($3==3?1/0:$2) notitle with points ls 43,\
       "mk_static.dat.3" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.3" using 1:($3==3?1/0:$2) notitle with points ls 43,\
       "mk_static.dat.4" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.4" using 1:($3==3?1/0:$2) notitle with points ls 43,\
       "mk_static.dat.5" using 1:($3==3?$2:1/0) notitle with points ls 3,\
       "mk_static.dat.5" using 1:($3==3?1/0:$2) notitle with points ls 43,\
       "time_xpp_h2_forward.dat" using 5:2 title "A (arrow indicates direction of time)" with lines ls 2;
\stopGNUPLOTscript

\startGNUPLOTscript[time_xpp_12]
  set xlabel "Time (days)";
  set ylabel "$A = $ T Cells ($\\times 10^3$)";
  set xrange [0:200];
  set ytics nomirror;
  set y2tics;
  set y2label "$a_{15} = δₚ$ level";
  set title "Parameter Range 0.1 to 2 (XPP)";
  set arrow from 49.54,0 to 49.54,1.6 nohead;
  set label "HB" at 49.54,1 right;
  plot "time_xpp_12.dat" using 1:2 title "A" with lines ls 1,\
       "time_xpp_12.dat" using 1:5 title "$a_{15}$" with lines ls 2 axes x1y2;
\stopGNUPLOTscript

\startGNUPLOTscript[time_py_12]
  set xlabel "Time (days)";
  set ylabel "$A = $ T Cells ($\\times 10^3$)";
  set xrange [0:200];
  set ytics nomirror;
  set y2tics;
  set y2label "$a_{15} = δₚ$ level";
  set title "Parameter Range 0.1 to 2 (Python)";
  set arrow from 49.54,0 to 49.54,1.6 nohead;
  set label "HB" at 49.54,1 right;
  plot "time_py_12.dat" using 1:2 title "A" with lines ls 1,\
       "time_py_12.dat" using 1:5 title "$a_{15}$" with lines ls 2 axes x1y2;
\stopGNUPLOTscript

\startGNUPLOTscript[time_xpp_21]
  set xlabel "Time (days)";
  set ylabel "$A = $ T Cells ($\\times 10^3$)";
  set xrange [0:200];
  set ytics nomirror;
  set y2tics;
  set y2label "$a_{15} = δₚ$ level";
  set title "Parameter Range 2 to 0.1 (XPP)";
  set arrow from 150.45,0 to 150.45,2.5 nohead;
  set label "HB" at 150.45,2 right;
  plot "time_xpp_21.dat" using 1:2 title "A" with lines ls 1,\
       "time_xpp_21.dat" using 1:5 title "$a_{15}$" with lines ls 2 axes x1y2;
\stopGNUPLOTscript

\startGNUPLOTscript[time_py_21]
  set xlabel "Time (days)";
  set ylabel "$A = $ T Cells ($\\times 10^3$)";
  set xrange [0:200];
  set ytics nomirror;
  set y2tics;
  set y2label "$a_{15} = δₚ$ level";
  set title "Parameter Range 2 to 0.1 (Python)";
  set arrow from 150.45,0 to 150.45,2.5 nohead;
  set label "HB" at 150.45,2 right;
  plot "time_py_21.dat" using 1:2 title "A" with lines ls 1,\
       "time_py_21.dat" using 1:5 title "$a_{15}$" with lines ls 2 axes x1y2;
\stopGNUPLOTscript

\startGNUPLOTscript[time_xpp_0523]
  set xlabel "Time (days)";
  set ylabel "$A = $ T Cells ($\\times 10^3$)";
  set xrange [0:200];
  set ytics nomirror;
  set y2tics;
  set y2label "$a_{15} = δₚ$ level";
  set title "Parameter Range 0.5 to 2.3 (XPP)";
  set arrow from 7.85,0 to 7.85,2.5 nohead;
  set label "HB" at 8.85,2 left;
  plot "time_xpp_0523.dat" using 1:2 title "A" with lines ls 1,\
       "time_xpp_0523.dat" using 1:5 title "$a_{15}$" with lines ls 2 axes x1y2;
\stopGNUPLOTscript

\startGNUPLOTscript[time_py_0523]
  set xlabel "Time (days)";
  set ylabel "$A = $ T Cells ($\\times 10^3$)";
  set xrange [0:200];
  set y2tics mirror;
  set y2label "$a_{15} = δₚ$ level";
  set title "Parameter Range 0.5 to 2.3 (Python)";
  set arrow from 7.85,0 to 7.85,2.5 nohead;
  set label "HB" at 8.85,2 left;
  plot "time_py_0523.dat" using 1:2 title "A" with lines ls 1,\
       "time_py_0523.dat" using 1:5 title "$a_{15}$" with lines ls 2 axes x1y2;
\stopGNUPLOTscript

\startGNUPLOTscript[time_xpp_12_long]
  set xlabel "Time (days)";
  set ylabel "$A = $ T Cells ($\\times 10^3$)";
  set xrange [0:1000];
  set ytics nomirror;
  set y2tics;
  set y2label "$a_{15} = δₚ$ level";
  set title "Parameter Range 0.1 to 2, 1000 Days (XPP)";
  set arrow from 148.64,0 to 148.64,3 nohead;
  set label "HB" at 148.64,2 right;
  plot "time_xpp_12_long.dat" using 1:2 title "A" with lines ls 1,\
       "time_xpp_12_long.dat" using 1:5 title "$a_{15}$" with lines ls 2 axes x1y2;
\stopGNUPLOTscript

\startGNUPLOTscript[time_py_12_long]
  set xlabel "Time (days)";
  set ylabel "$A = $ T Cells ($\\times 10^3$)";
  set xrange [0:1000];
  set ytics nomirror;
  set y2tics;
  set y2label "$a_{15} = δₚ$ level";
  set title "Parameter Range 0.1 to 2, 1000 Days (Python)";
  set arrow from 148.64,0 to 148.64,3 nohead;
  set label "HB" at 148.64,2 right;
  plot "time_py_12_long.dat" using 1:2 title "A" with lines ls 1,\
       "time_py_12_long.dat" using 1:5 title "$a_{15}$" with lines ls 2 axes x1y2;
\stopGNUPLOTscript

\startGNUPLOTscript[time_xpp_h2]
  set xlabel "Time (days)";
  set ylabel "$A = $ T Cells ($\\times 10^3$)";
  set xrange [0:3200];
  set ytics nomirror;
  set y2tics;
  set y2label "$a_{15} = δₚ$ level";
  set title "Demonstration of Ramping of Slowly Varying Parameter";
  set arrow from 2449,0 to 2449,1.6 nohead;
  set label "HB 2" at 2449,1 right;
  set arrow from 3147,0 to 3147,1.6 nohead;
  set label "HB" at 3147,1 right;
  plot "time_xpp_h2.dat" using 1:2 title "A" with lines ls 1,\
       "time_xpp_h2.dat" using 1:5 title "$a_{15}$" with lines ls 2 axes x1y2;
\stopGNUPLOTscript

\startGNUPLOTscript[time_xpp_h2_forward]
  set xlabel "Time (days)";
  set ylabel "$A = $ T Cells ($\\times 10^3$)";
  set xrange [0:3200];
  set yrange [0:2];
  set ytics nomirror;
  set y2tics;
  set y2label "$a_{15} = δₚ$ level";
  set title "Demonstration of Ramping of Slowly Varying Parameter (Forward Direction)";
  set arrow from 138.8,0 to 138.8,2 nohead;
  set label "HB 2" at 139,1 left;
  plot "time_xpp_h2_forward.dat" using 1:2 title "A" with lines ls 1,\
       "time_xpp_h2_forward.dat" using 1:5 title "$a_{15}$" with lines ls 2 axes x1y2;
\stopGNUPLOTscript

\startGNUPLOTscript[eigenvalues]
  set xlabel "$a_{15} = δₚ$ level";
  set ylabel "$\\mfunction{Re}(\\lambda)$";
  set ytics nomirror;
  set y2tics;
  set y2label "$\\mfunction{Im}(\\lambda)$";
  set title "Eigenvalues vs $a_{15}$";
  set key bottom right spacing 1.5;

  plot "mk_static.dat.1" using 1:6 title "\\math{\\mfunction{Re}(\\lambda)}" with lines ls 1,\
       "mk_static.dat.1" using 1:7 title "\\math{\\mfunction{Im}(\\lambda)}" with lines ls 2;
\stopGNUPLOTscript

\startGNUPLOTscript[eigenvalues_small]
  set xlabel "$a_{15} = δₚ$ level";
  set ylabel "$\\mfunction{Re}(\\lambda)$";

  set ytics nomirror;
  set y2tics;
  set y2label "$\\mfunction{Im}(\\lambda)$";
  set title "Eigenvalues vs $a_{15}$ (Detail)";

  plot "mk_static.dat.1" using 1:4 notitle with lines ls 3,\
       "mk_static.dat.1" using 1:6 notitle with lines ls 1,\
       "mk_static.dat.1" using 1:8 notitle with lines ls 1,\
       "mk_static.dat.1" using 1:5 notitle with lines ls 4,\
       "mk_static.dat.1" using 1:7 notitle with lines ls 2,\
       "mk_static.dat.1" using 1:9 notitle with lines ls 2;
\stopGNUPLOTscript
